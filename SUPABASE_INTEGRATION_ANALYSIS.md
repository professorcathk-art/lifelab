# Supabase é›†æˆåˆ†æ

## ğŸ“Š å½“å‰æ¶æ„åˆ†æ

### å½“å‰æ•°æ®å­˜å‚¨æ–¹å¼

1. **ç”¨æˆ·æ•°æ®** (`DataService.swift`)
   - ä½¿ç”¨ `UserDefaults` å­˜å‚¨
   - æœ¬åœ°å­˜å‚¨ï¼Œä¸è·¨è®¾å¤‡åŒæ­¥
   - æ•°æ®å¯èƒ½ä¸¢å¤±ï¼ˆå¸è½½åº”ç”¨ã€æ¸…é™¤æ•°æ®ï¼‰

2. **è®¤è¯ç³»ç»Ÿ** (`AuthService.swift`)
   - Email è®¤è¯ï¼šæ¨¡æ‹Ÿå®ç°ï¼ˆä»»ä½• email/password éƒ½å¯ä»¥ï¼‰
   - Apple Sign Inï¼šåŸºç¡€å®ç°ï¼Œä½†æ•°æ®ä»å­˜å‚¨åœ¨æœ¬åœ°
   - ç™»å½•çŠ¶æ€ï¼šå­˜å‚¨åœ¨ `UserDefaults`

3. **è®¢é˜…è®¡åˆ’** (`PaymentView.swift`)
   - ç›®å‰åªæ˜¯ UIï¼Œæ²¡æœ‰å®é™…æ”¯ä»˜é›†æˆ
   - æ²¡æœ‰è®¢é˜…çŠ¶æ€ç®¡ç†
   - æ²¡æœ‰è®¢é˜…éªŒè¯

---

## âœ… ä½¿ç”¨ Supabase çš„ä¼˜åŠ¿

### 1. æ•°æ®æŒä¹…åŒ–å’ŒåŒæ­¥
- âœ… **äº‘ç«¯å­˜å‚¨**ï¼šæ•°æ®ä¸ä¼šå› å¸è½½åº”ç”¨è€Œä¸¢å¤±
- âœ… **å¤šè®¾å¤‡åŒæ­¥**ï¼šç”¨æˆ·å¯ä»¥åœ¨ä¸åŒè®¾å¤‡ä¸Šè®¿é—®æ•°æ®
- âœ… **è‡ªåŠ¨å¤‡ä»½**ï¼šæ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ°äº‘ç«¯
- âœ… **æ•°æ®æ¢å¤**ï¼šå¯ä»¥æ¢å¤è¯¯åˆ çš„æ•°æ®

### 2. çœŸå®ç”¨æˆ·è®¤è¯
- âœ… **Email/Password è®¤è¯**ï¼šçœŸå®çš„ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- âœ… **Apple Sign In é›†æˆ**ï¼šSupabase åŸç”Ÿæ”¯æŒ
- âœ… **ç¤¾äº¤ç™»å½•**ï¼šå¯ä»¥è½»æ¾æ·»åŠ  Googleã€GitHub ç­‰
- âœ… **å¯†ç é‡ç½®**ï¼šè‡ªåŠ¨å¤„ç†å¯†ç é‡ç½®æµç¨‹
- âœ… **ä¼šè¯ç®¡ç†**ï¼šè‡ªåŠ¨ç®¡ç†ç”¨æˆ·ä¼šè¯å’Œ token

### 3. è®¢é˜…ç®¡ç†
- âœ… **è®¢é˜…çŠ¶æ€è·Ÿè¸ª**ï¼šå­˜å‚¨ç”¨æˆ·çš„è®¢é˜…è®¡åˆ’
- âœ… **è®¢é˜…éªŒè¯**ï¼šéªŒè¯ç”¨æˆ·æ˜¯å¦å·²è®¢é˜…
- âœ… **è®¢é˜…å†å²**ï¼šè®°å½•è®¢é˜…å˜æ›´å†å²
- âœ… **åˆ°æœŸæé†’**ï¼šå¯ä»¥è®¾ç½®è®¢é˜…åˆ°æœŸæé†’
- âœ… **æ”¯ä»˜é›†æˆ**ï¼šå¯ä»¥é›†æˆ Stripeã€RevenueCat ç­‰

### 4. æ•°æ®å®‰å…¨
- âœ… **Row Level Security (RLS)**ï¼šç»†ç²’åº¦çš„æ•°æ®è®¿é—®æ§åˆ¶
- âœ… **åŠ å¯†å­˜å‚¨**ï¼šæ•°æ®åŠ å¯†å­˜å‚¨
- âœ… **API å®‰å…¨**ï¼šè‡ªåŠ¨å¤„ç† API å®‰å…¨
- âœ… **ç”¨æˆ·éš”ç¦»**ï¼šæ¯ä¸ªç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®

### 5. å®æ—¶åŠŸèƒ½
- âœ… **å®æ—¶åŒæ­¥**ï¼šæ•°æ®å˜æ›´å®æ—¶åŒæ­¥åˆ°æ‰€æœ‰è®¾å¤‡
- âœ… **å®æ—¶è®¢é˜…**ï¼šå¯ä»¥ç›‘å¬æ•°æ®å˜æ›´
- âœ… **åä½œåŠŸèƒ½**ï¼šæœªæ¥å¯ä»¥æ·»åŠ åä½œåŠŸèƒ½

---

## ğŸ¯ å»ºè®®ï¼š**å¼ºçƒˆæ¨èä½¿ç”¨ Supabase**

### ä¸ºä»€ä¹ˆéœ€è¦ Supabaseï¼Ÿ

1. **ç”Ÿäº§ç¯å¢ƒå¿…éœ€**
   - å½“å‰æ¶æ„åªé€‚åˆæµ‹è¯•
   - ç”¨æˆ·æ•°æ®ä¼šä¸¢å¤±
   - æ— æ³•å¤šè®¾å¤‡ä½¿ç”¨

2. **è®¢é˜…åŠŸèƒ½å¿…éœ€**
   - éœ€è¦éªŒè¯ç”¨æˆ·è®¢é˜…çŠ¶æ€
   - éœ€è¦ç®¡ç†è®¢é˜…è®¡åˆ’
   - éœ€è¦å¤„ç†è®¢é˜…ç»­è´¹

3. **ç”¨æˆ·ä½“éªŒ**
   - æ•°æ®åŒæ­¥
   - å¤šè®¾å¤‡è®¿é—®
   - æ•°æ®å®‰å…¨

---

## ğŸ“‹ Supabase é›†æˆè®¡åˆ’

### Phase 1: åŸºç¡€è®¾ç½®
1. åˆ›å»º Supabase é¡¹ç›®
2. é…ç½®æ•°æ®åº“è¡¨ç»“æ„
3. è®¾ç½® Row Level Security (RLS)

### Phase 2: è®¤è¯é›†æˆ
1. é›†æˆ Supabase Auth
2. Email/Password è®¤è¯
3. Apple Sign In é›†æˆ
4. ä¼šè¯ç®¡ç†

### Phase 3: æ•°æ®å­˜å‚¨
1. ç”¨æˆ·èµ„æ–™è¡¨ (`user_profiles`)
2. ç”Ÿå‘½è“å›¾è¡¨ (`life_blueprints`)
3. è¡ŒåŠ¨è®¡åˆ’è¡¨ (`action_plans`)
4. ä»»åŠ¡è¡¨ (`tasks`)

### Phase 4: è®¢é˜…ç®¡ç†
1. è®¢é˜…è®¡åˆ’è¡¨ (`subscription_plans`)
2. ç”¨æˆ·è®¢é˜…è¡¨ (`user_subscriptions`)
3. è®¢é˜…çŠ¶æ€éªŒè¯
4. æ”¯ä»˜é›†æˆï¼ˆStripe/RevenueCatï¼‰

---

## ğŸ—„ï¸ å»ºè®®çš„æ•°æ®åº“è¡¨ç»“æ„

### 1. `user_profiles`
```sql
- id (uuid, primary key, references auth.users)
- basic_info (jsonb)
- interests (text[])
- created_at (timestamp)
- updated_at (timestamp)
```

### 2. `life_blueprints`
```sql
- id (uuid, primary key)
- user_id (uuid, references user_profiles)
- version (integer)
- vocation_directions (jsonb)
- strengths_summary (text)
- feasibility_assessment (text)
- created_at (timestamp)
```

### 3. `action_plans`
```sql
- id (uuid, primary key)
- user_id (uuid, references user_profiles)
- short_term (jsonb)
- mid_term (jsonb)
- long_term (jsonb)
- milestones (jsonb)
- today_tasks (jsonb)
- created_at (timestamp)
- updated_at (timestamp)
```

### 4. `user_subscriptions`
```sql
- id (uuid, primary key)
- user_id (uuid, references user_profiles)
- plan_type (text) -- 'yearly', 'quarterly', 'monthly'
- status (text) -- 'active', 'expired', 'cancelled'
- start_date (timestamp)
- end_date (timestamp)
- created_at (timestamp)
```

---

## ğŸ”§ é›†æˆå·¥ä½œé‡ä¼°ç®—

### ç®€å•é›†æˆï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰
- **æ—¶é—´**: 2-3 å¤©
- **å†…å®¹**:
  - Supabase é¡¹ç›®è®¾ç½®
  - è®¤è¯é›†æˆ
  - åŸºç¡€æ•°æ®åŒæ­¥

### å®Œæ•´é›†æˆï¼ˆåŒ…å«è®¢é˜…ï¼‰
- **æ—¶é—´**: 5-7 å¤©
- **å†…å®¹**:
  - æ‰€æœ‰ä¸Šè¿°åŠŸèƒ½
  - è®¢é˜…ç®¡ç†
  - æ”¯ä»˜é›†æˆ
  - é”™è¯¯å¤„ç†å’Œå›é€€æœºåˆ¶

---

## ğŸ’¡ å»ºè®®

### å¦‚æœè¿™æ˜¯ç”Ÿäº§åº”ç”¨ï¼š
**å¼ºçƒˆå»ºè®®ä½¿ç”¨ Supabase**

### å¦‚æœåªæ˜¯æµ‹è¯•/åŸå‹ï¼š
å¯ä»¥æš‚æ—¶ä½¿ç”¨å½“å‰æ¶æ„ï¼Œä½†éœ€è¦å°½å¿«è¿ç§»

### å¦‚æœè®¡åˆ’å•†ä¸šåŒ–ï¼š
**å¿…é¡»ä½¿ç”¨ Supabase**ï¼ˆæˆ–ç±»ä¼¼çš„åç«¯æœåŠ¡ï¼‰

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

å¦‚æœæ‚¨å†³å®šä½¿ç”¨ Supabaseï¼Œæˆ‘å¯ä»¥å¸®æ‚¨ï¼š

1. **è®¾ç½® Supabase é¡¹ç›®**
2. **åˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„**
3. **é›†æˆ Supabase Auth**
4. **å®ç°æ•°æ®åŒæ­¥**
5. **é›†æˆè®¢é˜…ç®¡ç†**

è¯·å‘Šè¯‰æˆ‘æ‚¨æ˜¯å¦éœ€è¦æˆ‘å¸®åŠ©é›†æˆ Supabaseï¼
