# 测试前检查清单

## ✅ 代码健康状态

- **编译状态**: ✅ 无错误
- **Linter 检查**: ✅ 无错误
- **关键功能**: ✅ 全部正常

---

## 📋 测试前准备步骤

### 1. Sandbox 账号设置

- [ ] **在设备设置中退出真实 Apple ID**
  - 设置 → App Store → Apple ID → 退出登录
  
- [ ] **准备 Sandbox 测试账号**
  - App Store Connect → 用户和访问 → 沙盒技术测试员
  - 确保已创建测试账号
  
- [ ] **参考文档**: `SANDBOX_ACCOUNT_FIX.md`

### 2. 设备准备

- [ ] **使用真实设备**（不是模拟器）
  - Sandbox 购买测试必须在真实 iPhone/iPad 上进行
  
- [ ] **确保设备时间正确**
  - 设置 → 通用 → 日期与时间 → 自动设置

### 3. 应用状态

- [ ] **清除旧数据**（如果需要）
  - 删除应用并重新安装
  - 或使用应用内的清除数据功能

---

## 🧪 测试项目

### 核心功能测试

- [ ] **初始扫描流程**
  - [ ] 基本资料填写
  - [ ] 兴趣选择
  - [ ] 天赋问卷
  - [ ] 价值观排序
  - [ ] AI 分析总结生成
  - [ ] 支付页面显示

- [ ] **进度指示器**
  - [ ] 进度点显示正确
  - [ ] 无法点击跳转（已禁用）
  - [ ] 必须按顺序完成步骤

- [ ] **状态恢复**
  - [ ] 完成问卷但未购买 → 回到支付页面
  - [ ] 未完成问卷 → 回到相应步骤
  - [ ] 已完成所有步骤 → 显示生命蓝图

- [ ] **应用内购买**
  - [ ] 产品加载成功
  - [ ] 价格显示正确
  - [ ] Sandbox 购买流程正常
  - [ ] 购买成功后生成蓝图
  - [ ] 错误处理正确

### UI/UX 测试

- [ ] **iPad 响应式布局**
  - [ ] 所有视图在 iPad 上正常显示
  - [ ] 内容居中且适当填充

- [ ] **主题切换**
  - [ ] 深色模式正常
  - [ ] 浅色模式正常

---

## ⚠️ 已知问题和注意事项

### Sandbox 测试

- **必须在真实设备上测试**
- **必须退出真实 Apple ID**
- **购买时应该看到 "Sandbox" 标识**
- **Sandbox 购买完全免费**

### 状态恢复

- 如果用户完成问卷但未购买，会回到支付页面
- 如果用户未完成问卷，会回到相应的问卷步骤
- 如果用户已完成所有步骤，会显示生命蓝图

### 进度指示器

- 进度点已禁用点击功能
- 用户必须按顺序完成所有步骤
- 无法跳过购买屏幕

---

## 🐛 如果遇到问题

### Sandbox 账号问题

1. 参考 `SANDBOX_ACCOUNT_FIX.md`
2. 确保已退出真实 Apple ID
3. 尝试删除并重新安装应用
4. 检查设备时间设置

### 状态恢复问题

1. 检查 `ContentView.swift` 中的状态恢复逻辑
2. 验证 `UserProfile` 数据是否正确保存
3. 检查 `InitialScanViewModel` 的状态初始化

### 购买问题

1. 检查 Product ID 是否匹配：`com.resonance.lifelab.yearly`
2. 确保 IAP 产品状态为 "準備提交" 或 "已批准"
3. 检查 `PaymentService` 的日志输出
4. 验证 Sandbox 账号是否正确登录

---

## 📊 测试结果记录

### 测试日期: ___________

### 测试设备: ___________

### 测试结果:

- [ ] 初始扫描流程: ✅ / ❌
- [ ] 进度指示器: ✅ / ❌
- [ ] 状态恢复: ✅ / ❌
- [ ] 应用内购买: ✅ / ❌
- [ ] iPad 布局: ✅ / ❌
- [ ] 主题切换: ✅ / ❌

### 发现的问题:

1. _______________________________________
2. _______________________________________
3. _______________________________________

---

**准备好开始测试了！** 🚀
